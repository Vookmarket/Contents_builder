# Contents Builder (Animal x Politics Info Automation)

動物×政治情報アカウントの運営を支援・自動化するためのツールです。
Google スプレッドシート上で動作し、AI (Gemini) を使って情報収集や台本作成を自動化します。

## 概要

このツールは **Google Apps Script (GAS)** という仕組みで動きますが、開発しやすくするために **TypeScript** という言語で書かれています。
このコードを Google のサーバーにアップロードして使います。

- **できること**:
  - ニュースサイトから最新情報を自動収集
  - AI が記事を読んで重要度を判定（スクリーニング）
  - YouTube や note 向けの原稿案を作成

---

## 🔰 初心者向けセットアップガイド

このツールを使うためには、ご自身のパソコンに開発環境（Node.js）を入れ、Google アカウントと連携させる必要があります。手順通りに進めてください。

### 1. 必要なものを準備する

1.  **Google アカウント**: Gmail などで使っているもの。
2.  **Node.js (推奨版)**:
    - プログラムを動かすための土台です。
    - [公式サイト](https://nodejs.org/ja/) から「推奨版 (LTS)」をダウンロードしてインストールしてください。
3.  **Visual Studio Code (VS Code) または Cursor**:
    - コードを編集するためのエディタです。

### 2. ツールのインストール

ターミナル（Macなら「ターミナル」、Windowsなら「PowerShell」）を開き、このプロジェクトのフォルダで以下のコマンドを入力して Enter を押してください。
必要なライブラリが自動でダウンロードされます。

```bash
npm install
```

### 3. Google アカウントとの連携

Google のサーバーにコードをアップロードするためのツール (`clasp`) にログインします。

```bash
npx clasp login
```

ブラウザが自動で開き、Google のログイン画面が出ます。このツールを実行したい Google アカウントでログインし、「許可」を押してください。
ターミナルに `Logged in!` と表示されればOKです。

### 4. GASプロジェクトの作成

Google ドライブ上に、このツールの実体となるファイル（GASプロジェクトとスプレッドシート）を新規作成します。

```bash
npx clasp create --type sheets --title "Contents Builder" --rootDir ./build
```

- 何か聞かれたら、矢印キーで操作して進めてください。
- 成功すると、`.clasp.json` というファイルが生成され、Google ドライブに新しいスプレッドシートが作られます。

### 5. コードのアップロード

手元のパソコンにあるコードを、先ほど作った Google ドライブ上のファイルに送ります。

```bash
npx clasp push
```

- 「Manifest file has been updated...」などと表示されれば成功です。

---

## ⚙️ 初期設定（重要）

アップロードができたら、AI を使うための鍵（APIキー）を設定します。

1.  **プロジェクトを開く**
    以下のコマンドで、ブラウザ上の GAS エディタを開きます。
    ```bash
    npx clasp open
    ```

2.  **スクリプトプロパティの設定**
    - 開いた画面の左側にある歯車アイコン（⚙️ **プロジェクトの設定**）をクリックします。
    - 画面下の方にある「**スクリプト プロパティ**」というセクションを探します。
    - 「**スクリプト プロパティを追加**」ボタンを押します。
    - 以下の通りに入力して「保存」を押します。
        - **プロパティ**: `GEMINI_API_KEY`
        - **値**: (Google AI Studio で取得した API キー)
          - ※キーがない場合は [Google AI Studio](https://aistudio.google.com/) から "Get API key" で作成してください。

---

## 🚀 使い方

### スプレッドシートを開く
GAS エディタ画面の上部にある「**コンテナ**」（スプレッドシートのアイコン）をクリックするか、Google ドライブから直接スプレッドシートを開いてください。

### メニューから実行する
スプレッドシートを開いて数秒待つと、メニューバーの右側に **「Contents Builder」** という新しいメニューが現れます。

1.  **Contents Builder** > **今すぐ収集を実行**
    - テスト用の情報収集プロセスが動きます（現在はログが出るだけです）。
2.  **Contents Builder** > **スクリーニング実行**
    - AI による分類処理が動きます（現在はログが出るだけです）。

※ 初回実行時は「承認が必要です」という画面が出ます。「権限を確認」→ アカウント選択 → 「詳細」→ 「Contents Builder（安全ではないページ）に移動」→ 「許可」と進んでください（自分が作ったプログラムなので安全です）。

---

## 開発者向け情報

### ディレクトリ構造
- `src/`: ソースコードが入っています。編集するのはここです。
- `build/`: アップロード用に変換されたファイルが入ります（手動でいじらないでください）。

### コマンド一覧
- `npm run build`: TypeScript をビルドします（`clasp push` で自動実行されます）。
- `npx clasp push`: コードをアップロードします。
- `npx clasp pull`: サーバー上の変更を手元にダウンロードします（スプレッドシート側でコードをいじった場合など）。

## ドキュメント
仕様の詳細は以下を参照してください。
- [要件定義書](要件定義書.md)
- [技術要件定義書](技術要件定義書.md)
